##### HTTP 协议（HyperText Transfer Protocol，超文本传输协议）：从万维网服务器传输超文本到本地浏览器的传送协议

HTTP协议工作于客户端-服务端（C/S）架构上

##### HTTP 通信过程：

浏览器作为 HTTP 客户端通过 URL向HTTP服务端即（WEB服务器）发送所有请求，Web服务器根据接收到的请求后，向客户端发送响应信息

HTTP **默认 端口号为 80**

##### 特点：

1：HTTP是**无连接的**，即每次只处理一个请求，服务器处理完请求即断开连接
2：HTTP是**媒体独立的，**即任何类型文件都可以用HTTP传输
3：HTTP是**无状态的，不具备保存之前发送过的请求或响应的功能**，通过 Cookie 和 Session 或者重写URl

### 1：HTTP报文格式

![请求报头.png](https://github.com/likang315/Web-Developing/blob/master/Web%20%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/3%EF%BC%9AHTTP%EF%BC%8CHTTPS/%E8%AF%B7%E6%B1%82%E6%8A%A5%E5%A4%B4.png?raw=true)

##### 请求报文：

请求报头：       请求方法 请求URL HTTP协议版本
              	 	 请求的首部字段

 			 可选内容实体	

请求行
请求首部字段
通用首部字段
实体首部字段
空行（CR+LF）
报文主体

##### 响应报文：

响应报头：    HTTP协议版本 状态码 用以解释状态码的短语
	      	      响应首部字段

响应主体：    (空一行)

 		     报文

状态行
响应首部字段
通用首部字段
实体首部字段
空行（CR+LF）
报文主体

### 2：HTTP的方法（8个），方法名大写

```c
1：GET	   获取资源         （请求访问指定的页面信息，并返回响应内容）
2：POST	   提交表单		    （向指定资源提交数据进行处理请求）
3：PUT	   修改数据         （从客户端向服务器传送的文档数据，保存）
4：HEAD	   获取报头         （返回报头）
5：DELETE   删除文件	    	（请求服务器删除指定的页面）
6：OPTIONS  查询支持的方法    （查询针对请求指定的资源支持方法）
7：TRACE    追踪路经          （让Web服务器端将之前的请求通信，环回给客户端，经过代理服务器，值-1）
8：CONNECT  使用隧道协议通信   (将连接改为网络隧道传输）
```

###### post 和 put 的区别：

?      Put 请求：如果两个请求相同，后一个请求会把第一个请求覆盖掉（所以PUT用来改资源）

?      Post 请求：两个相同请求，后一个请求不会把第一个请求覆盖掉（所以Post用来增资源）



### 3：HTTP 状态码：

由三个十进制数字组成，第一个十进制数字定义了状态码的类型，后两个数字没有分类的作用

```c
1** 	信息，服务器收到请求，需要请求者继续执行操作
2** 	成功，操作被成功接收并处理
3** 	重定向，需要进一步的操作以完成请求
4** 	客户端错误，服务器无法处理请求
5** 	服务器错误，服务器在处理请求错误
```




##### 301 永久重定向：

被请求的资源已永久移动到新位置，并且将来任何对此资源的引用都应该使用本响应返回的若干个URI之一，如果可能，拥有**链接编辑功能的客户端**应当自动 把 请求的地址修改为从服务器反馈回来的地址，而且这个响应也是可以缓存的

###### 302 临时重定向：

请求的资源现在临时从不同的URI响应请求。由于这样的重定向是临时的，客户端应当继续向原有地址发送以后的请求，只有在Cache-Control或Expires中进行了指定的情况下，这个响应才是可缓存的

浏览器对302状态码的处理：POST重定向为GET

###### 301 重定向 和 302 重定向 的 区别

　　302重定向只是暂时的重定向，搜索引擎会抓取新的内容而保留旧的地址，因为服务器返回302，所以，搜索搜索引擎认为新的网址是暂时的，而301重定向是永久的重定向，搜索引擎在抓取新的内容的同时也将旧的网址替换为了重定向之后的网址

### HTTP1.1新加入`303`和`307`状态码，把`302` 细分为：

303：对于POST请求，它表示**请求已经被处理**，客户端可以接着使用**GET方法去请求Location里的URI**

307：对于POST请求，表示**请求还没有被处理**，客户端应该**向Location里的URI重新发起POST请求**

##### 400 ： 请求无效

##### 403：禁止访问

服务端接收用户请求，但是拒绝响应。服务器可以返回拒绝响应的原因，如果不希望返回客户端具体原因，可以使用404（Not Found）来代替

###### 	403.1 - Execute access forbidden.

服务器禁止执行

###### 	403.2 - Read access forbidden.

服务器禁止读

###### 403.3 - Write access forbidden.

服务器禁止写

##### 404：请求的资源不存在

##### 500 ：内部服务器错误

##### 502：网关错误

作为网关或**者代理工作的服务器尝试执行请求时,从上游服务器接收到无效的响应**

##### 504：Nginx 错误

一般是Nginx做为**反向代理服务器的时候,所连接的应用服务器譬如Tomcat无相应导致的** 



### 4：报文首部字段：由首部字段名和字段值构成，中间用 '：'分隔

1：通用首部字段
2：请求首部字段
3：响应首部字段
4：实体首部字段

##### 通用首部字段

###### 1:Cache-Control:操作缓存

1：public  表明其他用户也可以利用缓存	
2：private 响应以特定的用户作为对象
3：no-cache 防止从缓存中返回过期的资源，或者不缓存过期的资源
4：no-store 不缓存在本地机器

###### 2:Connection :控制不在转发首部字段，管理持久连接

1：直接跟首部字段名，不在转发给代理的首部字段
2：HTTP/1.1版本默认的连接时持久连接，之前的版本是非持久连接，Close,Keep-Alive
3:Date :表明创建HTTP报文的日期和时间
4;Upgrade  :用于检测HTTP协议是够可以使用更高的协议，参数值为新的协议
5;Via ;为了追踪报文的转发，以及避免请求回环的发生
6:Warning :[警告码] [警告的主机:端口号] "[警告码]" （[日期时间]）

##### 请求首部字段

1:Accept：通知服务器，用户可以处理的媒体类型，以及媒体类型的优先级,q=来表示权重值（0-1）
2:Accept-Charset：通知服务器支持的字符集及字符集的相对优先级顺序
3:Accept-Encoding：通知服务器用户支持的内容的编码及内容编码的优先级顺序
4:Accept-Lanuage：通知服务器用户能够处理的语言集
5:From：告知服务器用户代理的电子邮件地址
6:Host：告知服务器，请求的资源所处的互联网主机名和端口号
7:If-Match:这种结构的请求首部字段，称为条件请求,只有条件判定为真时，执行
8:Max-Forwards ：值表示可经过服务器的最大数目，每经过服务器的值-1，为0时，直接返回响应

###### 9：Referer ：告知服务器请求的原始资源的URL

10:User-Agent：会创建情趣的浏览器和用户代理名称等信息传给服务器

##### 响应首部字段

1:Accept-Ranges：告知客户端，服务器可以处理范围请求，以指定获取服务器端某个部分的资源
2:Age ：告知客户端，原服务器在多久之前创建了响应
3:ETag ：告知客户端实体标识，一种将资源以字符串形式做唯一性标识的方式

###### 4:Location：将响应接受方引导至某个与请求URL位置不同的资源

##### 实体首部字段

1:Allow  通知客户端支持的HTTP方法
2:Content-Encoding
3:Content-Language
3;Content-Length：实体主体部分的大小
4:Content-location：表示报文主体返回资源对应的URL
5:Content-Type：实体主体的媒体类型
6:Expires：缓存资源的有效日期

### 为Cookie服务的首部字段

###### 1：Cookie ：带有用户状态信息的字段，sessionId

###### 2：Set-Cookie ：当服务器准备开始管理客户端的状态时，会事先告知各种信息

?	值：name，expires,path,domain=域名,
?	       Secure ：HTTPS安全通信时，才会发送
?	       HttpOnly ：加以限制，使其不可以被js访问



### 5：HTTP 特性： 

只要一端没有明确的提出断开连接，则保持TCP连接，**HTTP/1.1所有连接默认都是持久连接**

#####    管线化：   可以同时发送多个请求，解决了发送请求后需要等待并收到响应，才可以发送下一个请求问题

#####    Cookie技术：通过在请求和响应中写入Cookie信息来得到之前的状 态信息

Cookie会根据从服务器端发送的响应报文内一个Set-Cookie的首部字段信息通知客户端保存Cookie,当下次客户端再往该服务器发送请求时客户端会自动在请求报文中加入Cookie值后发送出去,服务器会检查是哪一个客户端发送的请求，然后对比服务器上的记录，得到状态信息
	

######   分块传输编码：在传输大容量数据时，通过把数据分割为多块，能够让浏览器逐步显示页面

######   恢复：指能从之前下载中断处恢复下载，需指定范围请求

######   内容协商机制：客户端和服务器就响应的资源内容进行交涉，然后提供给客户端最为合适的资源



### 6：Web 服务器

一个服务器可搭建多个独立域名的Web网站，利用虚拟主机（虚拟服务器）的功能
在相同IP下，由于虚拟主机可以寄存多个不同的主机名和域名的Web网站，所以发送请求时，必须在Host内完整制定域名的URL

通信数据转发的应用程序
a:代理，中间人的角色，把客户端发送的数据请求转发给服务器，同时也接受服务器的响应转发给客户端，使用代理服务器，利用缓存技术减少网络带宽流量，组织内部针对网站的访问控制
	1：缓存代理：将资源的副本保存到代理服务器上
	2：透明代理：不对报文做任何加工

b:网关，转发其他服务器通信数据的服务器，接受从客户端发送来的请求时，他就像拥有自己的资源一样对请求处理
利用网关可以提高通信的安全性，通过线路加密

c:隧道，在相隔甚远的客户端和服务器之间进行中转，并保持双方通信连接



### http 长轮询：

http 长轮询是服务器收到请求后如果有数据, 立刻响应请求; 如果没有数据就会 **等待一段时间**, 这段时间内如果有数据立刻响应请求; 如果时间到了还没有数据, 则响应 http 请求，浏览器受到 http 响应后**立即发送一个同样 http 请求**查询是否有数据

###### http 长轮询的局限

1. 浏览器端对统一服务器**同时 http 连接数有最大限制, 最好同一用户只存在一个长轮询**
2. 服务器端**没有数据 等待 连接时会造成浪费,** 容易产生服务器瓶颈

### http 短轮询：

http端轮询是服务器收到请求**不管是否有数据都直接响应 http 请求**; 浏览器受到 http 响应**隔一段时间**再发送同样的 http 请求查询是否有数据

http 短轮询的局限是**实时性低**

###### 两者相同点：

可以看出 http 长轮询和 http 短轮询的都会 hold 一段时间;

###### 两者不同点

间隔发生在服务端还是浏览器端: http 长轮询在服务端会 hold 一段时间, http 短轮询在浏览器端 “hold” 一段时间



### 7：HTTP的不足：

1：通信使用**明文**，不加密，内容可能会被窃听
2：不**验证双方的身份**，可能遭遇伪装
3：无法**证明报文的完整性**，可能被篡改

### 8：HTTPS(HTTP secure)：

用SSL(安全套接层)和TLS（安全层传输协议）组合的方式建立安全通信线路之后在使用HTTP通信被称为HTTPS

HTTP+加密+认证+完整性保护 = HTTPS

###### 1：内容加密解密机制

###### 2：SSL不仅提供加密手段还提供证书（由值得信任的第三方机构颁发）

###### 3：只用HTTPS通信地址栏会带有锁标志

   中间人攻击：请求或响应传输途中，遭遇攻击者拦截并篡改内容的攻击

 **共享密钥加密（对称密钥加密）：**加密和解密用同一个密钥的方式，**客户端随机生成对称秘钥**,这个秘钥可以是随机生成的
 **公开密钥加密：（非对称密钥）**使用一对非对称的密钥，一把私有密钥，一把公开密钥（浏览器内部植入的公钥证书)
 **数字证书认证机构：**对已申请者的公开密钥做数字签名，然后把公开密钥放入到公钥证书后绑定在一起，来验证公开密钥	的真实性

**HTTPS采用混合加密机制**：在交换密钥环节，使用非对称密钥加密(传输共享密钥)，之后建立的通道，通信报文则使用共享密钥加密方式

###### SSL慢分为两种：

1：通信慢
2：由于大量消耗CPU及内存资源，导致处理速度变慢，网络负载过重

###### HTTPS和HTTP的区别主要如下：

　　1、https协议需要到ca申请证书，一般免费证书较少，因而需要一定费用

　　2、http是超文本传输协议，信息是明文传输，https则是具有安全性的 ssl加密传输协议

　　3、http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443



### 9： 认证功能：Web页面只允许特定的人浏览

认证方式：
1：BASIC认证（基本认证）
2：DIGEST认证（摘要认证）
3：SSL客户端认证
4：表单认证：

######    BASIC认证：是Web服务器与通信客户端之间进行的认证方式（采用Base64编码方式）

######    DIGEST认证：使用质询/响应的方式，不会直接发送明文密码

   质询响应方式：一开始一方会先发送认证要求个另一方，接着使用从**另一方那接受到质询码（Base64编码）计算生成响应码（MD5运算） 最后返回响应码给对方进行验证**

######    SSL客户端认证：借助HTTPS客户端证书完成认证的方式

######    基于表单的认证：客户端会向服务器上的Web应用程序发送登录信息，按登录信息的验证结果验证

一般使用Cookie来管理Session（会话）

### 10：基于HTTP功能的追加协议

   WebSocket：Web浏览器和Web服务器之间全双工通信，是基于HTTP协议的，先HTTP发送请求然后切换成WebScoket协议通信

### 11：Web的攻击技术

攻击模式
	  主动攻击：攻击者直接访问Web应用，把攻击代码传入的攻击模式
	  被动攻击：利用圈套策略（诱使用户）执行攻击代码的攻击模式

因输出转义不完全引发的安全漏洞
1：跨站脚本攻击：Web网站注册用户的浏览器内运行非法的HMTL和JS代码进行的一种攻击
2：SQL注入攻击：针对Web应用使用的数据库，通过运行非法的SQL而产生的攻击
3：OS命令注入攻击：通过web应用，执行非法的操作系统命令（调用shell函数）达到攻击的目的
4：HTTP首部注入攻击：通过在响应首部字段内插入换行，添加任意响应首部或主体的攻击

###### 会话劫持：攻击者通过某种手段得到用户的会话ID，并伪装成用户，达到攻击的目的

###### 密码破解攻击：算出密码，突破认证

穷举法：指对所有密钥集合构成的密钥空间进行穷举
字典攻击:利用事先收集好的候选密码，经过各种方式组合存入字典，枚举字典中的密码,通过认证
彩虹表：明文密码及与之对应的散列值构成的一张数据库表，是一种实现制作庞大的彩虹表

###### 点击劫持：利用透明的按钮或链接做成陷阱，覆盖在Web页面之上，然后诱使用户点击访问内容的一种手段

###### DOS攻击(拒绝服务攻击)：一种让运行中的服务呈停止状态的攻击发大量请求让服务器难以分辨何为正常请求，何为攻击请求

###### 后门程序：开发人员设置的隐藏入口



### 12：双向认证 和 单向认证

证书：由 第三方可靠的，权威的机构证书颁发的证书（保存 IP信息、证书过期时间、证书所有者地址信息），证明自己是自己

###### 双向认证

　　1：先决条件是有两个或两个以上的证书，一个是服务端证书，另一个或多个是客户端证书

　　2：**服务端保存着客户端的证书并信任该证书，客户端保存着服务端的证书并信任该证书**，这样，在证书验证成功的情况下即可完成请求响应

　　3：双向认证一般企业应用对接

###### 单向认证

　　1：客户端保存着服务端的证书并信任该证书即可

　　2：https 一般是单向认证，这样可以让绝大部分人都可以访问你的站点



